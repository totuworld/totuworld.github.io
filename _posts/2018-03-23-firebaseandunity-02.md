---
layout: post
title:  "3ë¶„ ê²Œì„ ì„œë²„(Firebase) - Auth ì†Œì…œ ë¡œê·¸ì¸"
date: 2018-03-22 00:00:00
categories: nodejs firebase unity
comments: true
meta : nodejs firebase unity
description : Firebase ì¸ì¦(Authentication)ì„ í™œìš©í•´ Facebook ë¡œê·¸ì¸ ì œì‘
image :
  twitter: /images/fb_cover_03.png
  facebook: /images/fb_cover_03.png
publish : true
---

* content
{:toc}

## ë“¤ì–´ê°€ëŠ” ë§

ì§€ë‚œ ì‹œê°„ì— ë‹¤ë£¬ [ìµëª… ë¡œê·¸ì¸](https://blog.totu.dev/2018/03/22/firebaseandunity-01/)ì€ ê¸°ë³¸ì´ë‹¤. ìµëª… ë¡œê·¸ì¸ì€ Appleì˜ ì•±ìŠ¤í† ì–´ ê²€ìˆ˜ ì¡°ê±´ì—ë„ í•´ë‹¹í•œë‹¤.

ì‚¬ìš©ìê°€ ì„ íƒí•  ìˆ˜ ìˆëŠ” ê·¸ ë‹¤ìŒ ì„ íƒì§€ëŠ” ì†Œì…œ ë¡œê·¸ì¸ì´ë‹¤. ë¹„ë°€ë²ˆí˜¸ì™€ ê°™ì€ ìì‚°ì´ Facebookì´ë‚˜ Google ë“± ëŒ€í˜• íšŒì‚¬ê°€ ê´€ë¦¬ë˜ë‹ˆ ì•ˆì‹¬ë˜ê³  ì„¤ë ¹ ê²Œì„ì„ ì§€ì›Œë„ ë‹¤ì‹œ ë°ì´í„°ë¥¼ ë³µì›ì„ ê¸°ì¤€ì„ ì œê³µí•´ì£¼ê¸° ë•Œë¬¸ì´ë‹¤.

Firebase ì¸ì¦ì€ Google, Play ê²Œì„(êµ¬ê¸€ í”Œë ˆì´), Facebook, Twitter, Github ë“±ì˜ ë¡œê·¸ì¸ì´ ê°€ëŠ¥í•˜ë‹¤. ê·¸ ì¤‘ ì—¬ê¸°ì„œëŠ” í˜ì´ìŠ¤ë¶ ë¡œê·¸ì¸ì„ ë‹¤ë¤„ë³´ê² ë‹¤.

## ì¤€ë¹„ ê³¼ì •
Firebase ì¸ì¦ì˜ `ë¡œê·¸ì¸ ë°©ë²•`ì— Facebookì„ ë“±ë¡í•´ì•¼í•œë‹¤. ê·¸ëŸ¬ê¸°ìœ„í•´ì„œëŠ” Facebookì— ì•±ì„ ìƒì„±í•´ì•¼í•œë‹¤.

* [facebook for developersì˜ ì•± ëŒ€ì‹œë³´ë“œ](https://developers.facebook.com/apps/)ì— ì ‘ì† í•œ ë’¤ `ìƒˆ ì•± ì¶”ê°€` ë²„íŠ¼ì„ í´ë¦­í•œë‹¤.

    ![ìƒˆ ì•± ì¶”ê°€](/images/fb_03_01_01.png){:width="10%"}

* í‘œì‹œí•  ì´ë¦„ê³¼ ì—°ë½ì²˜ ì´ë©”ì¼ì„ ë“±ë¡í•œë‹¤.

    ![ìƒˆ ì•± IDë§Œë“¤ê¸° ì…ë ¥](/images/fb_03_01_02.png){:width="50%"}

* í˜ì´ìŠ¤ë¶ ì•±ì˜ ëŒ€ì‹œë³´ë“œ ì¤‘ `Facebook ë¡œê·¸ì¸`ì˜ `ì„¤ì •` ë²„íŠ¼ì„ í´ë¦­í•œë‹¤.

    ![Facebook ë¡œê·¸ì¸ ì„¤ì •](/images/fb_03_01_03.png){:width="30%"}

* ì´ì œ `ë¹ ë¥¸ ì‹œì‘` ì ˆì°¨ê°€ ì‹œì‘ëœë‹¤. ì´ë¥¼ ë¬´ì‹œí•˜ê³  ì¢Œì¸¡ ë©”ë‰´ì—ì„œ `ì„¤ì •` - `ê¸°ë³¸ ì„¤ì •`ì„ í´ë¦­í•˜ì—¬ `ì•± ID`ì™€ `ì•± ì‹œí¬ë¦¿ ì½”ë“œ`ë¥¼ í™•ì¸í•œë‹¤.

    ![ì„¤ì • - ê¸°ë³¸ ì„¤ì •](/images/fb_03_01_05.png){:width="30%"}

    ![ì•± IDì™€ ì•± ì‹œí¬ë¦¿ ì½”ë“œ í™•ì¸](/images/fb_03_01_06.png){:width="30%"}

* í•˜ë‹¨ì˜ `+ í”Œë«í¼ ì¶”ê°€` ë²„íŠ¼ì„ í´ë¦­í•˜ê³  iOSë‚˜ Android ë“±ì˜ í”Œë«í¼ì„ ì„ íƒí•œë‹¤(ì—¬ê¸°ì„œëŠ” iOSë¥¼ ê¸°ì¤€ìœ¼ë¡œ ì„¤ëª…í•œë‹¤). `ë²ˆë“¤ ID`ë¥¼ ì…ë ¥í•œë‹¤. ë‹¤ ì…ë ¥í•˜ë©´ í•˜ë‹¨ì˜ `ë³€ê²½ ë‚´ìš© ì €ì¥`ì„ í´ë¦­í•œë‹¤.

    ![iOS ë²ˆë“¤ ID ì…ë ¥](/images/fb_03_01_07.png){:width="80%"}

* ì´ì œ ì•„ëŒ€ì‹œë³´ë“œë¡œ ì ‘ì†í•˜ì—¬ `ë¡œê·¸ì¸ ë°©ë²•`íƒ­ì„ ì„ íƒí•œ ë’¤ `Facebook`ì„ í´ë¦­í•œë‹¤.

* `ì‚¬ìš© ì„¤ì •`ì„ í´ë¦­í•˜ê³  ì•ì„œ í™•ì¸í•œ `ì•± ID`ì™€ `ì•± ì‹œí¬ë¦¿ ì½”ë“œ`ë¥¼ ì…ë ¥í•œë‹¤. `OAuth ë¦¬ë””ë ‰ì…˜ URI`ë¥¼ ë³µì‚¬í•œë‹¤(ë³µì‚¬ ì•„ì´ì½˜ í´ë¦­)í•˜ê³  `ì €ì¥` ë²„íŠ¼ì„ í´ë¦­í•œë‹¤.

    ![ì•± ID, ì•± ì‹œí¬ë¦¿ ì½”ë“œ ì…ë ¥](/images/fb_03_01_08.png){:width="60%"}

* facebook for developers ëŒ€ì‹œë³´ë“œë¡œ ëŒì•„ê°€ì„œ ë³µì‚¬í•œ `OAuth ë¦¬ë””ë ‰ì…˜ URI`ë¥¼ `Facebook ë¡œê·¸ì¸` - `ì„¤ì •`ì—ì„œ `ìœ íš¨í•œ OAuth ë¦¬ë””ë ‰ì…˜ URI`ì— ë¶™ì—¬ë„£ê³  `ë³€ê²½ ë‚´ìš© ì €ì¥`ì„ í´ë¦­í•œë‹¤.

    ![ì¢Œì¸¡ ë©”ë‰´ì˜ Facebook ë¡œê·¸ì¸ - ì„¤ì •](/images/fb_03_01_09.png){:width="30%"}

    ![ìœ íš¨í•œ OAuth ë¦¬ë””ë ‰ì…˜ URI ì…ë ¥](/images/fb_03_01_10.png){:width="40%"}

## Facebook ë¡œê·¸ì¸

Facebook ë¡œê·¸ì¸ë„ ìµëª… ë¡œê·¸ì¸ê³¼ ë¹„ìŠ·í•œ ì ˆì°¨ë¡œ ì§„í–‰ëœë‹¤.

* ì‚¬ìš©ì) Facebook ë¡œê·¸ì¸ ë²„íŠ¼ í´ë¦­
* ê²Œì„ í´ë¼ì´ì–¸íŠ¸) Facebook SDKë¥¼ í™œìš©í•´ì„œ ë¡œê·¸ì¸ í™”ë©´ í‘œì‹œ
* ì‚¬ìš©ì) ë¡œê·¸ì¸ ì§„í–‰
* Facebook) access token ë°˜í™˜
* ê²Œì„ í´ë¼ì´ì–¸íŠ¸) access tokenì„ Firebase ì¸ì¦ SDKë¥¼ í†µí•´ ë“±ë¡
* Firebase) ì‚¬ìš©ì ë“±ë¡ ê³¼ì • ì§„í–‰
* ê²Œì„ í´ë¼ì´ì–¸íŠ¸) ê³ ìœ í•œ ì‚¬ìš©ì IDë¥¼ ì‚¬ìš©


### í”„ë¡œê·¸ë˜ë° ì¤€ë¹„

> [ìµëª… ë¡œê·¸ì¸](https://blog.totu.dev/2018/03/22/firebaseandunity-01/)ì„ ì§„í–‰í–ˆë‹¤ë©´ ê·¸ í”„ë¡œì íŠ¸ë¥¼ ì´ì–´ì„œ ì‚¬ìš©í•´ë„ ë¬´ë°©í•˜ë‹¤. 

* ì•„ë˜ í”„ë¡œì íŠ¸ íŒŒì¼ì„ ë‹¤ìš´ë°›ëŠ”ë‹¤.

    [ìƒ˜í”Œ í”„ë¡œì íŠ¸](https://github.com/totuworld/firebase_toturial/archive/auth_guest.zip)

* [Facebook SDK for Unity](https://developers.facebook.com/docs/unity)ë¡œ ì ‘ì†í•´ì„œ Facebook Unity SDKë¥¼ ë‹¤ìš´ë¡œë“œí•œë‹¤(ì‘ì„±ì¼ ê¸°ì¤€ v7.11.1).

* Unity 2017.3ë¥¼ ì‹¤í–‰í•œ ë’¤ ìƒ˜í”Œ í”„ë¡œì íŠ¸ë¥¼ ì—´ê³  [ìµëª… ë¡œê·¸ì¸](https://blog.totu.dev/2018/03/22/firebaseandunity-01/#í”„ë¡œì íŠ¸-ì„¤ì •)ì˜ `í”„ë¡œì íŠ¸ ì„¤ì •` ë¶€ë¶„ì„ ì°¸ê³ í•˜ì—¬ `GoogleService-Info.plist` íŒŒì¼ì„ ìƒì„±í•˜ì—¬ ìƒ˜í”Œ í”„ë¡œì íŠ¸ì— ì¶”ê°€í•œë‹¤. ë‹¤ìš´ë¡œë“œí•œ Facebook Unity SDKë„ ì¶”ê°€í•œë‹¤.


    Facebook Unity SDKë¥¼ ì¶”ê°€í•˜ë©´ Firebase Auth SDKì™€ ì¶©ëŒí•˜ëŠ” íŒŒì¼ì´ 4ê°œ ìˆë‹¤. í”„ë¡œì íŠ¸ì— ì‚¬ìš©ëœ Firebase Unity SDKëŠ” 4.3ì´ê³  Facebook Unity SDKëŠ” 7.11.1ì´ë‹¤. ì¶©ëŒì´ë‚˜ëŠ” íŒŒì¼ì€ `PlayServicesResolverì˜` í´ë”ì— ìˆëŠ” 4ê°œ íŒŒì¼ì¸ë° 1.2.59 ë²„ì „ íŒŒì¼ì„ ëª¨ë‘ ì‚­ì œí•œë‹¤.

    ![PlayServicesResolver ë‚´ íŒŒì¼ ì‚­ì œ](/images/fb_03_02_01.png){:width="80%"}

    > Android ë¹Œë“œëŠ” í™•ì¸í•´ë³´ì§€ ì•Šì•„ì„œ ì–´ë–¤ ë¬¸ì œê°€ ë°œìƒí• ì§€ ëª¨ë¦…ë‹ˆë‹¤.

* Unityì—ì„œ `Facebook` - `Edit Settings` ë©”ë‰´ ì„ íƒí•œ ë’¤ facebook for developersì—ì„œ í™•ì¸í•œ `ì•± ID`ë¥¼ ì…ë ¥í•œë‹¤.

    ![Facebook - Edit Settings ë©”ë‰´ ì„ íƒ](/images/fb_03_02_02.png){:width="20%"}
    ![Facebook ì•± ID ì…ë ¥](/images/fb_03_02_03.png){:width="50%"}


### Facebook ë¡œê·¸ì¸ êµ¬í˜„

Facebook ë¡œê·¸ì¸ì€ 2 ë‹¨ê³„ë¡œ ì§„í–‰ëœë‹¤. Facebook Unity SDKë¡œ ë¡œê·¸ì¸ì„ ì§„í–‰í•˜ê³ , Facebookì—ì„œ ë°˜í™˜í•œ access tokenìœ¼ë¡œ Firebase Auth SDKë¡œ ë“±ë¡ì„ ì§„í–‰í•œë‹¤.

* `gfb_auth_test.cs` ìŠ¤í¬ë¦½íŠ¸ë¥¼ ì—´ê³  ì•„ë˜ì²˜ëŸ¼ ë³€ê²½í•œë‹¤.
    * 8ë²ˆ ì¤„: usingìœ¼ë¡œ í•„ìš”í•œ ë„¤ì„ìŠ¤í˜ì´ìŠ¤ í˜•ì‹ ì‚¬ìš© í—ˆìš©(Facebook.Unity)
    * 29~32ë²ˆ ì¤„(`Start` ë©”ì„œë“œ ë‚´): Facebook SDKë¥¼ ì´ˆê¸°í™” ì¶”ê°€
    * 40~45ë²ˆ ì¤„: Firebase ì¸ì¦ SDKë¡œ signinì´ ëœ ìƒíƒœì¸ì§€ í™•ì¸í•˜ëŠ” í”„ë¡œí¼í‹° ì¶”ê°€
    * 90~184ë²ˆ ì¤„(í˜ì´ìŠ¤ë¶ ë¡œê·¸ì¸ ê´€ë ¨ ë©”ì„œë“œ region): í˜ì´ìŠ¤ë¶ ë¡œê·¸ì¸ì„ ì‹œë„í•˜ê³  firebaseì— ë“±ë¡í•˜ëŠ” ë©”ì„œë“œê°€ ëª¨ì—¬ìˆë‹¤. ì•„ë˜ íë¦„ë„ë¥¼ ì‚´í´ë³´ê³  ì½”ë“œë¥¼ ë³´ë©´ ì¡°ê¸ˆ ë” ì´í•´í•˜ê¸° ìˆ˜ì›”í•˜ë‹¤.

![í˜ì´ìŠ¤ë¶ íë¦„ë„](/images/fb_03_03_01.png)

{% gist /785a451847aebd36a548061a47cf261a gfb_auth_test_for_fb.cs %}

* gfb_auth_testì˜ `facebookLogin` ë©”ì„œë“œê°€ ì‹¤í–‰ë˜ì–´ì•¼ í˜ì´ìŠ¤ë¶ ë¡œê·¸ì¸ì„ ì‹œë„í•  ìˆ˜ ìˆë‹¤.
    * Canvas - Button ê²Œì„ ì˜¤ë¸Œì íŠ¸ì˜ Button ì»´í¬ë„ŒíŠ¸ë¥¼ ì°¾ì•„ì„œ ë³µì‚¬í•œ ë’¤ ì ë‹¹íˆ ìœ„ì¹˜ ì‹œí‚¤ê³  `Facebook Login`ìœ¼ë¡œ í…ìŠ¤íŠ¸ë¥¼ ë³€
    * gfb_auth_test ìŠ¤í¬ë¦½íŠ¸ì˜ `facebookLogin`ì„ ì„ íƒí•œë‹¤.

    ![ë²„í° ë³µì‚¬ í›„ í…ìŠ¤íŠ¸ ë³€ê²½](/images/fb_03_03_02.png){:width="30%"}
    ![ë²„íŠ¼ ì—°ê²°](/images/fb_03_03_03.png){:width="50%"}

### ë””ë²„ê¹…

Firebase ì¸ì¦ SDKë¡œ Facebook ë¡œê·¸ì¸ì„ ì‹œë„í•˜ë©´ Unity Editorì—ì„œëŠ” ë””ë²„ê¹…ì´ ë¶ˆê°€ëŠ¥í•˜ë‹¤. ë¹Œë“œ í›„ ì•± í´ë¼ì´ì–¸íŠ¸ì—ì„œ í™•ì¸í•´ì•¼í•œë‹¤.

> iOSì˜ ë¹Œë“œì˜ ê²½ìš° Facebook SDK ì¶”ê°€ í›„ ë¹Œë“œ ì‹œ Build Setttingì—ì„œ Enable Bitcodeë¥¼ Noë¡œ ì„¤ì •í•´ì•¼ linker ì—ëŸ¬ ì—†ì´ ì§„í–‰ëœë‹¤.

![ë“±ë¡ í™•ì¸](/images/fb_03_04_01.png)

Facebook ë¡œê·¸ì¸ í›„ Firebaseì— ë“±ë¡ì„ ë§ˆì¹˜ë©´ ìœ„ ê·¸ë¦¼ì²˜ëŸ¼ ë‚˜íƒ€ë‚œë‹¤.

[ì™„ë£Œëœì†ŒìŠ¤ì½”ë“œ](https://github.com/totuworld/firebase_toturial/archive/auth_facebook.zip)

## ë§ˆë¬´ë¦¬

ê°„ë‹¨íˆ ëë‚  ë‚´ìš©ì´ì—ˆëŠ”ë° linker ì—ëŸ¬ì™€ Firebase ë‚´ì˜ Facebook ì•± IDë¥¼ ì˜ëª» ì…ë ¥í•´ì„œ ë§ì€ ë¹Œë“œ ì‹¤íŒ¨ê°€ ìˆì—ˆë‹¤. ê¼­ ì„¤ì •ì€ 2ë²ˆ 3ë²ˆ í™•ì¸í•˜ê¸¸ ë°”ë€ë‹¤.

ê·¸ë¦¬ê³  ì´ëŸ° ë‹¤ì–‘í•œ ë¬¸ì œë¥¼ í•´ê²°í•˜ê³  ìˆëŠ” í´ë¼ì´ì–¸íŠ¸ í”„ë¡œê·¸ë˜ë¨¸ ì—¬ëŸ¬ë¶„ ëŒ€ë‹¨í•˜ì‹­ë‹ˆë‹¤ğŸ‘ğŸ‘ğŸ‘.

---

## ì°¸ê³ ìë£Œ
* [Authenticate Using Facebook Login and Unity](https://firebase.google.com/docs/auth/unity/facebook-login)
* [Link Multiple Auth Providers to an Account in Unity](https://firebase.google.com/docs/auth/unity/account-linking)
* [Facebook SDK for Unity - Examples](https://developers.facebook.com/docs/unity/examples#login)
* [Facebook SDK for Unity isssue 135](https://github.com/facebook/facebook-sdk-for-unity/issues/135)